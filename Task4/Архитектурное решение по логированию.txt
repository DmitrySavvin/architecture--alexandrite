1. Мотивация
Внедрение логирования позволит более детально анализировать причину сбоев в системе. Помимо самого факта нарушения и компонента, в работе которого выявлено нарушение, логирование позволяет анализировать информацию о состоянии системы, исходных и промежуточных данных в конкретный момент времени. Внедрение совместно с мониторингом и трейсингом позволит оперативно выявлять и устранять проблемные места в системе.
Технические решения, на которые повлияет внедрение логирования:
	1. Каждый компонент системы, задействованный в сборе логов, должен поддерживать инструмент логирования, либо быть доработан для такой поддержки.
	2. Собираемые логи необходимо хранить в отдельном месте системы (необходимо дополнительно выделить ресурсы).
Бизнес-метрики, на которые повлияет внедрение логирования (аналогично трейсингу):
- число заказов
- средний чек клиента
- время проводимое на сайе
- число повторных посетителей

Так как имеется ограничение команды на оновременное внедрение логирования и трейсинга предлагается в первую очередь настроить логирование для следующих компонентов:
- Message Queue
- 3d files storage
- Shop DB
- MES DB

Данное разделение сделано по логике разделения типа задачи. Для логирования интересно наблюдать состояние ключевых компонентов системы.

2. Предлагаемое решение
Собирать логи предлагается с использованием стека ELK (Elastiksearch, Logstash, Kibana). Помимо непосредственного сорка логов  использование данного стека позволит хранить, анализировать и визуализировать данные.

Предлагается использовать логи следующиз уровней: FATAL, INFO, WARN и TRACE.
Список необходимых логов с уровнем INFO:
- В очередь сообщений (Message Queue) пришло новое сообщение
- Сообщение ушло из очереди Message Queue
- Данные модели поступили в хранилище для расчета
- Логирование промежуточных этапов расчета модели (уровни детализации уточняются при изучении исходного кода MES)
- Расчет модели завершен
- В базах данных фиксируется новый заказ, изменение статуса заказа
Уровень логирования FATAL используется для оперативного информирования о критичных ошибках в работе компонентов.
Уровень логирования WARN будет использован для информирования об отклонениях поведения системы от нормального и алертинга пользователей.
Уровень логирования TRACE будет задействован на этапе рефакторинга системы, а также в случаях моделирования инцидентов.

При доработке системы сбора логов в систему анализа логов необходимо дополнительно реализовать следующие мероприятия:
	1. Реализация анализа частотности сохранения записей в каждом компоненте - для выявления аномалий в виде большого числа запросов или отстутствия ожидаемых запросов.
	2. Реализация анализа размеров исходных данных, наличие эквивалентных запросов на расчет - для выявления и исключение аномальных нагрузок на расчетное ядро.
	3. Внедрение разработанных анализоваторов в Elasticsearch.
Так как в систему анализа логов на первом этапе добавляются только наиболее важные компоненты необходимо настроить алертинг при изменении пороговых значений, параметров, влияющих на работоспособность компонентов системы - количество запросов, нагрузка.
