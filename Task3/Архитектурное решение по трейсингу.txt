1. Мотивация.
В случай сбоя в системе ввиду сложности данной системы время на локализацию и выявления проблемного компонента может привести к потере заказов и простою в производстве. Внедрение трейсинга позволит в случае проблем в системе быстро найти причину и принять мероприятия для устранения недостатков.
Внедрение трейсинга повлияет на следующие бизнес-метрики:
- число заказов
- средний чек клиента
- время проводимое на сайе
- число повторных посетителей
Технические решения, на которые повлияет внедрение трейсинга:

Трейсинг в первую очередь предлагается настроить для следующих компонентов:
- Shop API
- MES API
- CRM API
Данное выделение компонентов реализовано по логике разделения типа задачи. В трейсинге нас больше интересует путь прохождения запросов.

2. Предлагаемое решение
Внедрение OpenTeemetry позволит собирать и обрабатывать данные телеметрии. Для визуализации данных предлагается к внедрению Jaeger.
Мониторинг прохождения заказа реализован с помощью фиксации для каждлого запроса всех подзапросов в системе.
Новые компоненты и связи отражены на схеме:


3. Компромиссы
При внедрении трейсинга дополнительно необходимо оценить исходный код ПО MES. Потенциально в данной части системы доработка ПО для выдачи метрик в необходимом формате может оказаться слишком дорогостоящей.

4. Безопасность 
Для предотвращения несанкционированного доступа необходимо реализация обработки запросов с jwt токеном после успешной авторизации в приложении. Дополнительно в рамказх работы системы атворизации необходимо обеспечить ролевую модель для ограничения доступа в CRM, MES API и веб-интерфейс MES. 
Для работы системы трейсинга предлагается работа системы как пользователя с полными правами доступа, но с ограничением времени жизни токена, а также с жесткой привязкой IP адреса (или набора адресов) для аутентификации.
